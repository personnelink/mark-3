String.prototype.format=function(){for(var t=this,i=arguments.length;i--;)t=t.replace(new RegExp("\\{"+i+"\\}","gm"),arguments[i]);return t},!function(t){t.timeoutDialog=function(i){var o,e={timeout:1200,countdown:60,title:"Your session is about to expire!",message:"You will be logged out in {0} seconds.",question:"Do you want to stay signed in?",keep_alive_button_text:"Yes, Keep me signed in",sign_out_button_text:"No, Sign me out",keep_alive_url:"/keep-alive",logout_url:null,logout_redirect_url:"/",restart_on_yes:!0,startTime:0,dialog_width:350,mobile_popup:!1,cookie_name:"Ticket"};t.extend(e,i);var n={init:function(){this.setupDialogTimer()},setupDialogTimer:function(t){var i=this;"undefined"==typeof t&&(t=e.timeout-e.countdown),e.startTime=this.returnTime(),window.setTimeout(function(){var t=!1;if(0!==e.startTime){var o=i.returnTime();o!==e.startTime&&o-e.startTime>0&&(t=!0,extendTime=o-e.startTime,i.setupDialogTimer(extendTime))}t||i.setupDialog()},1e3*t)},setupDialog:function(){var i=this;i.destroyDialog(),e.mobile_popup?(0===t("#timeout-dialog").length&&(t('<div id="timeout-dialog" data-overlay-theme="c" data-theme="b" data-dismissible="false" data-role="popup"><div class="timeout-popup-container ui-bar ui-bar-b ui-corner-all"><div class="ui-bar ui-bar-a">'+e.title+'</div><div class="ui-content"><div id="timeout-message">'+e.message.format('<span id="timeout-countdown">'+e.countdown+"</span>")+'</div><div id="timeout-question">'+e.question+'</div><hr><button type="button" id="timeout-keep-signin-btn" class="ui-btn ui-btn-a">'+e.keep_alive_button_text+'</button><button type="button" id="timeout-sign-out-button" class="ui-btn ui-btn-a">'+e.sign_out_button_text+"</button></div></div></div>").appendTo("body"),o=t("#timeout-dialog"),o.popup()),o.popup("open")):(0===t("#timeout-dialog").length&&t('<div class="time-wrapper" style="display: none;" class="k-content"><div id="timeout-dialog"><p id="timeout-message">'+e.message.format('<span id="timeout-countdown">'+e.countdown+"</span>")+'</p><p id="timeout-question">'+e.question+'</p><br/><hr><br/><div class="container_12"><div class="grid_6"><button type="button" id="timeout-sign-out-button" class="k-button">'+e.sign_out_button_text+'</button></div><div class="grid_6" style="text-align:right"><button type="button" id="timeout-keep-signin-btn" class="k-button">'+e.keep_alive_button_text+"</button></div></div></div></div>").appendTo("body"),o=t("#timeout-dialog").kendoWindow({width:"430px",title:e.title,actions:[],modal:!0,resizable:!1}).data("kendoWindow").center().open()),t(document).on("click","#timeout-keep-signin-btn",function(){i.keepAlive()}),t(document).on("click","#timeout-sign-out-button",function(){i.signOut(!0)}),i.startCountdown()},destroyDialog:function(){t("#timeout-dialog").length&&(t(document).off("click","#timeout-keep-signin-btn"),t(document).off("click","#timeout-sign-out-button"),e.mobile_popup?o.popup("close"):o&&o.close())},startCountdown:function(){var i=this,o=e.countdown;this.countdown=window.setInterval(function(){o-=1,t("#timeout-countdown").html(o),0>=o&&(window.clearInterval(i.countdown),i.signOut(!1))},1e3)},keepAlive:function(){var i=this;this.destroyDialog();var o=!1;window.clearInterval(this.countdown),t.get(e.keep_alive_url,function(t){try{if(o=e.mobile_popup?"000"===t.status.code:"OK"===t,!o)throw"Response Error";e.restart_on_yes&&(e.startTime=i.returnTime(),i.setupDialogTimer())}catch(n){i.signOut(!1)}})},signOut:function(i){var o=this;this.destroyDialog(),null!==e.logout_url?t.post(e.logout_url,function(t){o.redirectLogout(i)}):o.redirectLogout(i)},redirectLogout:function(t){var i=e.logout_redirect_url;window.location=i},returnTime:function(){var i=0;if(void 0!==t.cookie&&void 0!==t.cookie(e.cookie_name)){var o=t.cookie(e.cookie_name),n=o.match(new RegExp("Ctime=(.*?)($|&)","i"));void 0!==n[1]&&(i=n[1])}return i}};n.init()}}(window.jQuery);
